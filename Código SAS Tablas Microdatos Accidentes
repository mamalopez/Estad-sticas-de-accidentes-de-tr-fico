/* CREAMOS UNA TABLA MARCO CON LAS TABLAS PARA IMPORTAR Y MANIPULAR */

DATA TFM.TABLAS_MICRODATOS;
LENGTH TABLAS $30;
INPUT TABLAS $;
CARDS;
Tabla_accvict_24h_2008
Tabla_accvict_24h_2009
Tabla_accvict_24h_2010
;
RUN;

/* CREAMOS UNA MACRO PARA IMPORTAR TABLAS DESDE UN MISMO DIRECTORIO Y SE LES DA EL FORMATO ADECUADO 
Y LOS VALORES CORRESPONDIENTES A LAS VARIABLES DE DICHAS TABLAS */

%MACRO ACCIDINT(TABLAS);

proc import out=&TABLAS
datafile="C:\Users\HP\Documents\TFM\Trabajo\ESPAÑA (dgt)\&TABLAS..csv"
dbms=csv replace;
getnames=yes;
datarow=2;
run;

data tfm.&TABLAS;
FORMAT MES_2 $20. DIASEMANA_2 $10. COMUNIDAD_AUTONOMA_2 $50. ISLA_2 $20. ZONA_2 $20. TIPO_ACCIDENTE_2 $80.
FACTORES_ATMOSFERICOS_2 $20. SUPERFICIE_CALZADA_2 $20.  LUMINOSIDAD_2 $20. TIPO_VIA_2 $20. RED_CARRETERA_2 $20. DENSIDAD_CIRCULACION_2 $20.
PROVINCIA_2 $30.;
SET tfm.&TABLAS;
IF MES = 1 THEN MES_2 = 'ENERO';
IF MES = 2 THEN MES_2 = 'FEBRERO';
IF MES = 3 THEN MES_2 = 'MARZO';
IF MES = 4 THEN MES_2 = 'ABRIL';
IF MES = 5 THEN MES_2 = 'MAYO';
IF MES = 6 THEN MES_2 = 'JUNIO';
IF MES = 7 THEN MES_2 = 'JULIO';
IF MES = 8 THEN MES_2 = 'AGOSTO';
IF MES = 9 THEN MES_2 = 'SEPTIEMBRE';
IF MES = 10 THEN MES_2 = 'OCTUBRE';
IF MES = 11 THEN MES_2 = 'NOVIEMBRE';
IF MES = 12 THEN MES_2 = 'DICIEMBRE';
IF DIASEMANA = 1 THEN DIASEMANA_2= 'LUNES';
IF DIASEMANA = 2 THEN DIASEMANA_2= 'MARTES';
IF DIASEMANA = 3 THEN DIASEMANA_2= 'MIERCOLES';
IF DIASEMANA = 4 THEN DIASEMANA_2= 'JUEVES';
IF DIASEMANA = 5 THEN DIASEMANA_2= 'VIERNES';
IF DIASEMANA = 6 THEN DIASEMANA_2= 'SABADO';
IF DIASEMANA = 7 THEN DIASEMANA_2= 'DOMINGO';
IF PROVINCIA = 1 THEN PROVINCIA_2 = 	'Araba/Álava';
IF PROVINCIA = 2 THEN PROVINCIA_2 = 	'Albacete';
IF PROVINCIA = 3 THEN PROVINCIA_2 = 	'Alicante/Alacant';
IF PROVINCIA = 4	THEN PROVINCIA_2 = 'Almería';
IF PROVINCIA = 5	THEN PROVINCIA_2 = 'Ávila';
IF PROVINCIA = 6	THEN PROVINCIA_2 = 'Badajoz';
IF PROVINCIA = 7	THEN PROVINCIA_2 = 'Balears, Illes';
IF PROVINCIA = 8	THEN PROVINCIA_2 = 'Barcelona';
IF PROVINCIA = 9	THEN PROVINCIA_2 = 'Burgos';
IF PROVINCIA = 10	THEN PROVINCIA_2 = 'Cáceres';
IF PROVINCIA = 11	THEN PROVINCIA_2 = 'Cádiz';
IF PROVINCIA = 12	THEN PROVINCIA_2 =  'Castellón/Castelló';
IF PROVINCIA = 13	THEN PROVINCIA_2 = 'Ciudad Real';
IF PROVINCIA = 14	THEN PROVINCIA_2 = 'Córdoba';
IF PROVINCIA = 15	THEN PROVINCIA_2 = 'Coruña, A';
IF PROVINCIA = 16	THEN PROVINCIA_2 =  'Cuenca';
IF PROVINCIA = 17	THEN PROVINCIA_2 = 'Girona';
IF PROVINCIA = 18	THEN PROVINCIA_2 = 'Granada';
IF PROVINCIA = 19	THEN PROVINCIA_2 = 'Guadalajara';
IF PROVINCIA = 20	THEN PROVINCIA_2 = 'Gipuzkoa';
IF PROVINCIA = 21	THEN PROVINCIA_2 = 'Huelva';
IF PROVINCIA = 22	THEN PROVINCIA_2 = 'Huesca';
IF PROVINCIA = 23	THEN PROVINCIA_2 = 'Jaén';
IF PROVINCIA = 24	THEN PROVINCIA_2 = 'León';
IF PROVINCIA = 25	THEN PROVINCIA_2 =  'Lleida';
IF PROVINCIA = 26	THEN PROVINCIA_2 =  'Rioja, La';
IF PROVINCIA = 27	THEN PROVINCIA_2 =  'Lugo';
IF PROVINCIA = 28	THEN PROVINCIA_2 = 'Madrid';
IF PROVINCIA = 29	THEN PROVINCIA_2 =  'Málaga';
IF PROVINCIA = 30	THEN PROVINCIA_2 =  'Murcia';
IF PROVINCIA = 31	THEN PROVINCIA_2 =  'Navarra';
IF PROVINCIA = 32	THEN PROVINCIA_2 =  'Ourense';
IF PROVINCIA = 33	THEN PROVINCIA_2 =  'Asturias';
IF PROVINCIA = 34	THEN PROVINCIA_2 =  'Palencia';
IF PROVINCIA = 35	THEN PROVINCIA_2 = 'Palmas, Las';
IF PROVINCIA = 36	THEN PROVINCIA_2 =  'Pontevedra';
IF PROVINCIA = 37	THEN PROVINCIA_2 =  'Salamanca';
IF PROVINCIA = 38	THEN PROVINCIA_2 =  'S.C.Tenerife';
IF PROVINCIA = 39	THEN PROVINCIA_2 =  'Cantabria';
IF PROVINCIA = 40	THEN PROVINCIA_2 =  'Segovia';
IF PROVINCIA = 41	THEN PROVINCIA_2 =  'Sevilla';
IF PROVINCIA = 42	THEN PROVINCIA_2 =  'Soria';
IF PROVINCIA = 43	THEN PROVINCIA_2 =  'Tarragona';
IF PROVINCIA = 44	THEN PROVINCIA_2 =  'Teruel';
IF PROVINCIA = 45	THEN PROVINCIA_2 =  'Toledo';
IF PROVINCIA = 46	THEN PROVINCIA_2 =  'Valencia/València';
IF PROVINCIA = 47	THEN PROVINCIA_2 =  'Valladolid';
IF PROVINCIA = 48	THEN PROVINCIA_2 =  'Bizkaia';
IF PROVINCIA = 49	THEN PROVINCIA_2 = 'Zamora';
IF PROVINCIA = 50	THEN PROVINCIA_2 =  'Zaragoza';
IF PROVINCIA = 51	THEN PROVINCIA_2 =  'Ceuta';
IF PROVINCIA = 52	THEN PROVINCIA_2 =  'Melilla';
IF COMUNIDAD_AUTONOMA =  1	THEN COMUNIDAD_AUTONOMA_2 = 'Andalucía';
IF COMUNIDAD_AUTONOMA = 2	THEN COMUNIDAD_AUTONOMA_2= 'Aragón';
IF COMUNIDAD_AUTONOMA = 3	THEN COMUNIDAD_AUTONOMA_2 = 'Asturias, Principado de';
IF COMUNIDAD_AUTONOMA = 4	THEN COMUNIDAD_AUTONOMA_2 = 'Balears, Illes';
IF COMUNIDAD_AUTONOMA = 5	THEN COMUNIDAD_AUTONOMA_2 = 'Canarias';
IF COMUNIDAD_AUTONOMA = 6	THEN COMUNIDAD_AUTONOMA_2 = 'Cantabria';
IF COMUNIDAD_AUTONOMA = 7	THEN COMUNIDAD_AUTONOMA_2 = 'Castilla y León';
IF COMUNIDAD_AUTONOMA = 8	THEN COMUNIDAD_AUTONOMA_2 = 'Castilla-La Mancha';
IF COMUNIDAD_AUTONOMA = 9	THEN COMUNIDAD_AUTONOMA_2 = 'Cataluña';
IF COMUNIDAD_AUTONOMA = 10	THEN COMUNIDAD_AUTONOMA_2 = 'Comunitat Valenciana';
IF COMUNIDAD_AUTONOMA = 11	THEN COMUNIDAD_AUTONOMA_2 = 'Extremadura';
IF COMUNIDAD_AUTONOMA = 12	THEN COMUNIDAD_AUTONOMA_2 = 'Galicia';
IF COMUNIDAD_AUTONOMA = 13	THEN COMUNIDAD_AUTONOMA_2 = 'Comunidad de Madrid';
IF COMUNIDAD_AUTONOMA = 14	THEN COMUNIDAD_AUTONOMA_2 = 'Murcia, Región de';
IF COMUNIDAD_AUTONOMA = 15	THEN COMUNIDAD_AUTONOMA_2 = 'Comunidad Foral de Navarra';
IF COMUNIDAD_AUTONOMA = 16	THEN COMUNIDAD_AUTONOMA_2 = 'La Rioja';
IF COMUNIDAD_AUTONOMA = 17	THEN COMUNIDAD_AUTONOMA_2 = 'País Vasco';
IF COMUNIDAD_AUTONOMA = 18	THEN COMUNIDAD_AUTONOMA_2= 'Ceuta y Melilla';
IF ISLA = 71 THEN ISLA_2 = 'MALLORCA';
IF ISLA = 72 THEN ISLA_2 = 'MENORCA';
IF ISLA = 73 THEN ISLA_2 = 'IBIZA';
IF ISLA = 74 THEN ISLA_2 = 'FORMENTERA';
IF ISLA = 351 THEN ISLA_2 = 'GRAN CANARIA';
IF ISLA = 352 THEN ISLA_2 = 'FUERTEVENTURA';
IF ISLA = 353 THEN ISLA_2 = 'LANZAROTE';
IF ISLA = 381 THEN ISLA_2 = 'TENERIFE';
IF ISLA = 382 THEN ISLA_2 = 'LA PALMA';
IF ISLA = 383 THEN ISLA_2 = 'GOMERA';
IF ISLA = 384 THEN ISLA_2 = 'HIERRO';
IF ZONA = 1 THEN ZONA_2 = 'CARRETERA';
IF ZONA = 2 THEN ZONA_2 = 'ZONA URBANA';
IF ZONA = 3 THEN ZONA_2 = 'TRAVESÍA';
IF ZONA = 4 THEN ZONA_2 = 'VARIANTE';
IF TIPO_ACCIDENTE= 11 THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículos en marcha (Frontal)';
IF TIPO_ACCIDENTE= 12 THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículos en marcha (Frontolateral)';
IF TIPO_ACCIDENTE= 13 THEN TIPO_ACCIDENTE_2 =	'Colisión de vehículos en marcha (Lateral)';
IF TIPO_ACCIDENTE= 14	THEN TIPO_ACCIDENTE_2 ='Colisión de vehículos en marcha (Alcance)';
IF TIPO_ACCIDENTE= 15	THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículos en marcha (Múltiple o en caravana)';
IF TIPO_ACCIDENTE= 21	THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículo con obstáculo en calzada (Vehículo estacionado o averiado)';
IF TIPO_ACCIDENTE= 22	THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículo con obstáculo en calzada (Valla de defensa)';
IF TIPO_ACCIDENTE= 23	THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículo con obstáculo en calzada (Barrera de paso a nivel)';
IF TIPO_ACCIDENTE= 24	THEN TIPO_ACCIDENTE_2 = 'Colisión de vehículo con obstáculo en calzada (Otro objeto o material)';
IF TIPO_ACCIDENTE= 31	THEN TIPO_ACCIDENTE_2 = 'Atropello a peatón sosteniendo bicicleta';
IF TIPO_ACCIDENTE= 32	THEN TIPO_ACCIDENTE_2 = 'Atropello a peatón reparando vehículo';
IF TIPO_ACCIDENTE= 33	THEN TIPO_ACCIDENTE_2 = 'Atropello a peatón aislado o en grupo';
IF TIPO_ACCIDENTE= 34	THEN TIPO_ACCIDENTE_2 = 'Atropello a conductor de animales';
IF TIPO_ACCIDENTE= 35	THEN TIPO_ACCIDENTE_2 = 'Atropello a animal conducido o en rebaño';
IF TIPO_ACCIDENTE= 36	THEN TIPO_ACCIDENTE_2 = 'Atropello a animales sueltos';
IF TIPO_ACCIDENTE= 41	THEN TIPO_ACCIDENTE_2 = 'Vuelco en la calzada';
IF TIPO_ACCIDENTE= 51	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda con colisión (Choque con árbol o poste)';
IF TIPO_ACCIDENTE= 52	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda con colisión (Choque con muro o edifício)';
IF TIPO_ACCIDENTE= 53	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda con colisión (Choque con cuneta o bordillo)';
IF TIPO_ACCIDENTE= 54	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda con colisión (Otro tipo de choque)';
IF TIPO_ACCIDENTE= 55	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda sin colisión (Con despeñamiento)';
IF TIPO_ACCIDENTE= 56	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda sin colisión (Con vuelco)';
IF TIPO_ACCIDENTE= 57	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda sin colisión (En llano)';
IF TIPO_ACCIDENTE= 58	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la izquierda sin colisión (Otra)';
IF TIPO_ACCIDENTE= 61	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha con colisión (Choque con árbol o poste)';
IF TIPO_ACCIDENTE= 62	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha con colisión (Choque con muro o edifício)';
IF TIPO_ACCIDENTE= 63	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha con colisión (Choque con cuneta o bordillo)';
IF TIPO_ACCIDENTE= 64	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha con colisión (Otro tipo de choque)';
IF TIPO_ACCIDENTE= 65	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha sin colisión (Con despeñamiento)';
IF TIPO_ACCIDENTE= 66	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha sin colisión (Con vuelco)';
IF TIPO_ACCIDENTE= 67	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha sin colisión (En llano)';
IF TIPO_ACCIDENTE= 68	THEN TIPO_ACCIDENTE_2 = 'Salida de la vía por la derecha sin colisión (Otra)';
IF TIPO_ACCIDENTE= 71	THEN TIPO_ACCIDENTE_2 = 'Otro tipo de accidente';
IF FACTORES_ATMOSFERICOS =  1	THEN FACTORES_ATMOSFERICOS_2 = 'BUEN TIEMPO';
IF FACTORES_ATMOSFERICOS =  2	THEN FACTORES_ATMOSFERICOS_2 = 'NIEBLA INTENSA';
IF FACTORES_ATMOSFERICOS =  3	THEN FACTORES_ATMOSFERICOS_2 = 'NIEBLA LIGERA';
IF FACTORES_ATMOSFERICOS =  4	THEN FACTORES_ATMOSFERICOS_2 = 'LLOVIZNANDO';
IF FACTORES_ATMOSFERICOS =  5	THEN FACTORES_ATMOSFERICOS_2 = 'LLUVIA FUERTE';
IF FACTORES_ATMOSFERICOS =  6	THEN FACTORES_ATMOSFERICOS_2 = 'GRANIZANDO';
IF FACTORES_ATMOSFERICOS =  7	THEN FACTORES_ATMOSFERICOS_2 = 'NEVANDO';
IF FACTORES_ATMOSFERICOS =  8	THEN FACTORES_ATMOSFERICOS_2 = 'VIENTO FUERTE';
IF FACTORES_ATMOSFERICOS =  9	THEN FACTORES_ATMOSFERICOS_2 = 'OTRO';
IF SUPERFICIE_CALZADA = 1	THEN SUPERFICIE_CALZADA_2 = 'SECA Y LIMPIA';
IF SUPERFICIE_CALZADA =  2	THEN SUPERFICIE_CALZADA_2 = 'UMBRÍA';
IF SUPERFICIE_CALZADA =  3	THEN SUPERFICIE_CALZADA_2 = 'MOJADA';
IF SUPERFICIE_CALZADA =  4	THEN SUPERFICIE_CALZADA_2 = 'HELADA';
IF SUPERFICIE_CALZADA =  5	THEN SUPERFICIE_CALZADA_2 = 'NEVADA';
IF SUPERFICIE_CALZADA =  6	THEN SUPERFICIE_CALZADA_2 = 'BARRILLO';
IF SUPERFICIE_CALZADA =  7	THEN SUPERFICIE_CALZADA_2 = 'GRAVILLA SUELTA';
IF SUPERFICIE_CALZADA =  8	THEN SUPERFICIE_CALZADA_2 = 'ACEITE';
IF SUPERFICIE_CALZADA = 9	THEN SUPERFICIE_CALZADA_2 = 'OTRO TIPO';
IF LUMINOSIDAD = 1	THEN LUMINOSIDAD_2 = 'PLENO DÍA';
IF LUMINOSIDAD = 2	THEN LUMINOSIDAD_2 = 'CREPÚSCULO';
IF LUMINOSIDAD = 3	THEN LUMINOSIDAD_2 = 'NOCHE: ILUMINACIÓN SUFICIENTE';
IF LUMINOSIDAD = 4	THEN LUMINOSIDAD_2 = 'NOCHE: ILUMINACIÓN INSUFICIENTE';
IF LUMINOSIDAD = 5	THEN LUMINOSIDAD_2 = 'NOCHE: SIN ILUMINACIÓN';
IF TIPO_VIA = 1	THEN TIPO_VIA_2 = 'AUTOPISTA';
IF TIPO_VIA = 2	THEN TIPO_VIA_2 = 'AUTOVÍA';
IF TIPO_VIA = 3	THEN TIPO_VIA_2 = 'VÍA PARA AUTOMÓVILES';
IF TIPO_VIA = 4	THEN TIPO_VIA_2 = 'VÍA CONVENCIONAL CON CARRIL LENTO';
IF TIPO_VIA = 5	THEN TIPO_VIA_2 = 'VÍA CONVENCIONAL';
IF TIPO_VIA = 6	THEN TIPO_VIA_2 = 'CAMINO VECINAL';
IF TIPO_VIA = 7	THEN TIPO_VIA_2 = 'VÍA DE SERVICIO';
IF TIPO_VIA = 8	THEN TIPO_VIA_2 = 'RAMAL DE ENLACE';
IF TIPO_VIA = 9	THEN TIPO_VIA_2 = 'OTRO TIPO';
IF RED_CARRETERA = 1	THEN RED_CARRETERA_2 =  'TITULARIDAD ESTATAL';
IF RED_CARRETERA = 2	THEN RED_CARRETERA_2 =  'TITULARIDAD AUTONÓMICA';
IF RED_CARRETERA = 3	THEN RED_CARRETERA_2 =  'TITULARIDAD PROVINCIAL (DIPUTACIÓN, CABILDO O CONSELL)';
IF RED_CARRETERA = 4	THEN RED_CARRETERA_2 =  'TITULARIDAD MUNICIPAL';
IF RED_CARRETERA = 5	THEN RED_CARRETERA_2 =  'OTRAS TITULARIDADES';
IF DENSIDAD_CIRCULACION = 1	THEN DENSIDAD_CIRCULACION_2 = 'FLUIDA';
IF DENSIDAD_CIRCULACION = 2	THEN DENSIDAD_CIRCULACION_2 = 'DENSA';
IF DENSIDAD_CIRCULACION = 3	THEN DENSIDAD_CIRCULACION_2 = 'CONGESTIONADA';
ID_ACCIDENTE_2=PUT(ID_ACCIDENTE,z13.);
drop ID_ACCIDENTE ANIO MES HORA DIASEMANA PROVINCIA COMUNIDAD_AUTONOMA ISLA MUNICIPIO
ZONA ZONA_AGRUPADA CARRETERA RED_CARRETERA TIPO_VIA TRAZADO_NO_INTERSEC TIPO_INTERSEC
SUPERFICIE_CALZADA LUMINOSIDAD FACTORES_ATMOSFERICOS DENSIDAD_CIRCULACION
VISIBILIDAD_RESTRINGIDA ACERAS TIPO_ACCIDENTE OTRA_CIRCUNSTANCIA ISLA;
rename ID_ACCIDENTE_2=ID_ACCIDENTE MES_2=MES DIASEMANA_2=DIASEMANA PROVINCIA_2=PROVINCIA 
COMUNIDAD_AUTONOMA_2=COMUNIDAD_AUTONOMA ISLA_2=ISLA
ZONA_2=ZONA RED_CARRETERA_2=RED_CARRETERA TIPO_VIA_2=TIPO_VIA SUPERFICIE_CALZADA_2=SUPERFICIE_CALZADA LUMINOSIDAD_2=LUMINOSIDAD 
FACTORES_ATMOSFERICOS_2=FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE_2=TIPO_ACCIDENTE DENSIDAD_CIRCULACION_2=DENSIDAD_CIRCULACION;
RUN;


%MEND;

data _null_;
set TFM.TABLAS_MICRODATOS;
call execute( '%importar(' || TABLAS || ')');
RUN;

data _null_;
set TFM.TABLAS_MICRODATOS;
call execute( '%importar(' || TABLAS || ')');
RUN;


DATA TFM.TABLAS_ACCVICT_COMPLETO_2;
SET tfm.Tabla_accvict_24h_2008_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE DENSIDAD_CIRCULACION)
tfm.Tabla_accvict_24h_2009_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE DENSIDAD_CIRCULACION)
tfm.Tabla_accvict_24h_2010_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE DENSIDAD_CIRCULACION)
tfm.Tabla_accvict_2011_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE)
tfm.Tabla_accvict_2012_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE)
tfm.Tabla_accvict_2013_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE)
tfm.Tabla_accvict_2014_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE)
tfm.Tabla_accvict_2015_2 (keep=ID_ACCIDENTE MES DIASEMANA PROVINCIA 
COMUNIDAD_AUTONOMA ISLA
ZONA RED_CARRETERA TIPO_VIA SUPERFICIE_CALZADA LUMINOSIDAD 
FACTORES_ATMOSFERICOS
TIPO_ACCIDENTE)
;
RUN;


/*Podemos realizar un tratamiento distinto a renombrar variables. Podemos cruzar las tablas de microdatos de la DGT
con tablas que contengan las equivalencias de los valores numéricos de las variables*/

proc sql;
create table tfm.TABLA_VEHIC_24H_2008_3 as
select A.*, B.TIPO_VEHICULO AS TIPO_VEHICULO_2
FROM TFM.Tabla_vehic_24h_2008_2 AS A LEFT JOIN TFM.TIPO_VEHICULO as b
ON A.TIPO_VEHICULO = B.Variable;
proc sql;
create table tfm.TABLA_VEHIC_24H_2008_3 as
select A.*, B.ESTADO_VEHICULO AS ESTADO_VEHICULO_2
FROM TFM.Tabla_vehic_24h_2008_3 AS A LEFT JOIN TFM.ESTADO_VEHICULO as b
ON A.ESTADO_VEHICULO = B.Variable;



proc sql;
create table tfm.TABLA_VEHIC_24H_2009_3 as
select A.*, B.TIPO_VEHICULO AS TIPO_VEHICULO_2
FROM TFM.Tabla_vehic_24h_2009_2 AS A LEFT JOIN TFM.TIPO_VEHICULO as b
ON A.TIPO_VEHICULO = B.Variable;
proc sql;
create table tfm.TABLA_VEHIC_24H_2009_3 as
select A.*, B.ESTADO_VEHICULO AS ESTADO_VEHICULO_2
FROM TFM.Tabla_vehic_24h_2009_3 AS A LEFT JOIN TFM.ESTADO_VEHICULO as b
ON A.ESTADO_VEHICULO = B.Variable;



proc sql;
create table tfm.TABLA_VEHIC_24H_2010_3 as
select A.*, B.TIPO_VEHICULO AS TIPO_VEHICULO_2
FROM TFM.Tabla_vehic_24h_2010_2 AS A LEFT JOIN TFM.TIPO_VEHICULO as b
ON A.TIPO_VEHICULO = B.Variable;
proc sql;
create table tfm.TABLA_VEHIC_24H_2010_3 as
select A.*, B.ESTADO_VEHICULO AS ESTADO_VEHICULO_2
FROM TFM.Tabla_vehic_24h_2010_3 AS A LEFT JOIN TFM.ESTADO_VEHICULO as b
ON A.ESTADO_VEHICULO = B.Variable;

